<head></head>
<body>
    <script src="https://lifestylecommunities--scheddev.sandbox.my.site.com/lightning/lightning.out.js"></script>
    <script>
        var url = "https://www.lifestylecommunities.com.au/communities/lifestyle-ridgelea";

        // Extract the last parameter containing "lifestyle"
        var lastParameter = url.match(/\/lifestyle-(.*)$/i)[1];
        
        // Remove dashes and format the parameter
        var formattedParameter = lastParameter.replace(/-/g, ' ').replace(/^(lifestyle )?/i, '').replace(/\b\w/g, function (match) {
            return match.toUpperCase();
        });
        
        console.log(formattedParameter); 
        let inputVariables = [{ name : "community",
                             type : "String",
                             value : formattedParameter}];
        $Lightning.use("c:AppointmentBookingApp",    // name of the Lightning app
            function() {                  
                $Lightning.createComponent(
                   "lightning:flow", // top-level component of your app
                    { },                  // attributes to set on the component when created
                    "lightningLocator",   // the DOM location to insert the component
                    function(cmp) {
                        console.log('Hi from callback');// callback when component is created and active on the page
                        cmp.startFlow('Scheduled_Flow_Appointment_Booking',inputVariables);
                    }
                );
            }, 'https://lifestylecommunities--scheddev.sandbox.my.site.com/appointmentbooking'  // Community endpoint
        );
    </script>

<div id="lightningLocator">
  <p>Lightning Component mentioned in the Script is invoked from here.</p>
</div>
</body>
